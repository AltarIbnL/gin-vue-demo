{"ast":null,"code":"import \"core-js/modules/es.json.stringify.js\";\nimport \"core-js/modules/es.function.name.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport storageService from '../../../service/storageService';\nimport userService from '../../../service/userService';\nvar userModule = {\n  namespaced: true,\n  state: {\n    token: storageService.get(storageService.USER_TOKEN),\n    userInfo: JSON.parse(storageService.get(storageService.USER_INFO))\n  },\n  mutations: {\n    SET_TOKEN: function SET_TOKEN(state, token) {\n      // 更新本地缓存\n      storageService.set(storageService.USER_TOKEN, token); // 更新state\n\n      state.token = token;\n    },\n    SET_USERINFO: function SET_USERINFO(state, userInfo) {\n      // 更新本地缓存\n      storageService.set(storageService.USER_INFO, JSON.stringify(userInfo)); // 更新state\n\n      state.userInfo = userInfo;\n    }\n  },\n  actions: {\n    register: function register(context, _ref) {\n      var name = _ref.name,\n          telephone = _ref.telephone,\n          password = _ref.password;\n      return new Promise(function (resolve, reject) {\n        // userService.register(this.user).then((res) => { // 前面的register是用户输入完之后发给后端，then是执行接收到后端返回的数据以后,在后端的register之后\n        userService.register({\n          name: name,\n          telephone: telephone,\n          password: password\n        }).then(function (res) {\n          // 保存token\n          console.log(res.data);\n          context.commit('SET_TOKEN', res.data.token); // 将token 储存在vuex中，代码在store/index 和module user.js中\n          // this.$store.commit('userModule/SET_TOKEN', res.data.token);  // 将token 储存在vuex中，代码在store/index 和module user.js中\n\n          return userService.info();\n        }).then(function (res) {\n          // 从后端的info页面获取数据, 链式调用\n          // 保存用户信息\n          // this.SET_USERINFO(response.data.data.user); // 将用户信息储存在vuex中，代码在store/index 和module user.js中\n          context.commit('SET_USERINFO', res.data.data.user); // 将用户信息储存在vuex中，代码在store/index 和module user.js中\n\n          resolve(res);\n        }).catch(function (err) {\n          reject(err);\n        });\n      });\n    },\n    login: function login(context, _ref2) {\n      var telephone = _ref2.telephone,\n          password = _ref2.password;\n      return new Promise(function (resolve, reject) {\n        // userService.register(this.user).then((res) => { // 前面的register是用户输入完之后发给后端，then是执行接收到后端返回的数据以后,在后端的register之后\n        userService.login({\n          telephone: telephone,\n          password: password\n        }).then(function (res) {\n          // 保存token\n          console.log(res.data);\n          context.commit('SET_TOKEN', res.data.token); // 将token 储存在vuex中，代码在store/index 和module user.js中\n\n          return userService.info();\n        }).then(function (res) {\n          // 从后端的info页面获取数据, 链式调用\n          // 保存用户信息\n          context.commit('SET_USERINFO', res.data.data.user); // 将用户信息储存在vuex中，代码在store/index 和module user.js中\n\n          resolve(res);\n        }).catch(function (err) {\n          reject(err);\n        });\n      });\n    }\n  }\n};\nexport default userModule;","map":{"version":3,"names":["storageService","userService","userModule","namespaced","state","token","get","USER_TOKEN","userInfo","JSON","parse","USER_INFO","mutations","SET_TOKEN","set","SET_USERINFO","stringify","actions","register","context","name","telephone","password","Promise","resolve","reject","then","res","console","log","data","commit","info","user","catch","err","login"],"sources":["E:/seafile/file/GO/pratical_practice/vue/vue/src/store/module/user.js"],"sourcesContent":["import storageService from '../../../service/storageService';\nimport userService from '../../../service/userService';\n\nconst userModule = {\n  namespaced: true,\n  state: {\n    token: storageService.get(storageService.USER_TOKEN),\n    userInfo: JSON.parse(storageService.get(storageService.USER_INFO)),\n  },\n  mutations: {\n    SET_TOKEN(state, token) {\n      // 更新本地缓存\n      storageService.set(storageService.USER_TOKEN, token);\n      // 更新state\n      state.token = token;\n    },\n    SET_USERINFO(state, userInfo) {\n      // 更新本地缓存\n      storageService.set(storageService.USER_INFO, JSON.stringify(userInfo));\n      // 更新state\n      state.userInfo = userInfo;\n    },\n  },\n  actions: {\n    register(context, { name, telephone, password }) {\n      return new Promise((resolve, reject) => {\n        // userService.register(this.user).then((res) => { // 前面的register是用户输入完之后发给后端，then是执行接收到后端返回的数据以后,在后端的register之后\n        userService.register({ name, telephone, password }).then((res) => {\n          // 保存token\n          console.log(res.data);\n          context.commit('SET_TOKEN', res.data.token); // 将token 储存在vuex中，代码在store/index 和module user.js中\n          // this.$store.commit('userModule/SET_TOKEN', res.data.token);  // 将token 储存在vuex中，代码在store/index 和module user.js中\n          return userService.info();\n        }).then((res) => { // 从后端的info页面获取数据, 链式调用\n          // 保存用户信息\n          // this.SET_USERINFO(response.data.data.user); // 将用户信息储存在vuex中，代码在store/index 和module user.js中\n          context.commit('SET_USERINFO', res.data.data.user); // 将用户信息储存在vuex中，代码在store/index 和module user.js中\n          resolve(res);\n        }).catch((err) => {\n          reject(err);\n        });\n      });\n    },\n    login(context, { telephone, password }) {\n      return new Promise((resolve, reject) => {\n        // userService.register(this.user).then((res) => { // 前面的register是用户输入完之后发给后端，then是执行接收到后端返回的数据以后,在后端的register之后\n        userService.login({ telephone, password }).then((res) => {\n          // 保存token\n          console.log(res.data);\n          context.commit('SET_TOKEN', res.data.token); // 将token 储存在vuex中，代码在store/index 和module user.js中\n          return userService.info();\n        }).then((res) => { // 从后端的info页面获取数据, 链式调用\n          // 保存用户信息\n          context.commit('SET_USERINFO', res.data.data.user); // 将用户信息储存在vuex中，代码在store/index 和module user.js中\n          resolve(res);\n        }).catch((err) => {\n          reject(err);\n        });\n      });\n    },\n  },\n};\nexport default userModule;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}